# ログイン(U02) 単体テストケース一覧

## 正常系テスト

### U02-C1001
- 正常系
- テスト観点
    - ログインが正常に完了すること
    - JWTトークンが返却されること
    - レスポンスのステータスコードが200であること
    - ログメッセージ「I-U0002」が出力されること
- 入力値
    - username: testuser
    - password: password123
- 備考
    - 事前に該当ユーザを登録しておく

### U02-C1002
- 正常系
- テスト観点
    - 最小文字数のユーザ名でログインが正常に完了すること
    - JWTトークンが返却されること
    - レスポンスのステータスコードが200であること
- 入力値
    - username: a
    - password: minpasswd
- 備考
    - 事前に該当ユーザを登録しておく

### U02-C1003
- 正常系
- テスト観点
    - 最大文字数のユーザ名でログインが正常に完了すること
    - JWTトークンが返却されること
    - レスポンスのステータスコードが200であること
- 入力値
    - username: abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTU (50文字)
    - password: password123
- 備考
    - 事前に該当ユーザを登録しておく

### U02-C1004
- 正常系
- テスト観点
    - 最小文字数のパスワードでログインが正常に完了すること
    - JWTトークンが返却されること
    - レスポンスのステータスコードが200であること
- 入力値
    - username: testuser
    - password: p (1文字)
- 備考
    - 事前に該当ユーザを登録しておく

### U02-C1005
- 正常系
- テスト観点
    - JWTトークンのペイロードに正しいuser_idとusernameが含まれること
    - トークンの有効期限が1時間に設定されていること
    - レスポンスのステータスコードが200であること
- 入力値
    - username: testuser
    - password: password123
- 備考
    - 返却されたJWTトークンをデコードして内容を検証

## 異常系テスト - バリデーションエラー

### U02-E2001
- 異常系
    - ユーザ名バリデーションエラー（空文字）
- テスト観点
    - バリデーションエラーが発生すること
    - エラーメッセージ「E-U0007」が出力されること
    - レスポンスのステータスコードが400であること
- 入力値
    - username: （空文字）
    - password: password123

### U02-E2002
- 異常系
    - ユーザ名バリデーションエラー（51文字以上）
- テスト観点
    - バリデーションエラーが発生すること
    - エラーメッセージ「E-U0007」が出力されること
    - レスポンスのステータスコードが400であること
- 入力値
    - username: abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUV (51文字)
    - password: password123

### U02-E2003
- 異常系
    - パスワードバリデーションエラー（空文字）
- テスト観点
    - バリデーションエラーが発生すること
    - エラーメッセージ「E-U0008」が出力されること
    - レスポンスのステータスコードが400であること
- 入力値
    - username: testuser
    - password: （空文字）

### U02-E2004
- 異常系
    - パスワードバリデーションエラー（256文字以上）
- テスト観点
    - バリデーションエラーが発生すること
    - エラーメッセージ「E-U0008」が出力されること
    - レスポンスのステータスコードが400であること
- 入力値
    - username: testuser
    - password: 256文字以上の長い文字列
- 備考
    - 255文字を超える文字列を設定

## 異常系テスト - 認証エラー

### U02-E2005
- 異常系
    - 存在しないユーザ名
- テスト観点
    - ユーザ存在チェックエラーが発生すること
    - エラーメッセージ「E-U0010」が出力されること
    - レスポンスのステータスコードが401であること
- 入力値
    - username: nonexistentuser
    - password: password123

### U02-E2006
- 異常系
    - パスワード不一致
- テスト観点
    - パスワード照合エラーが発生すること
    - エラーメッセージ「E-U0012」が出力されること
    - レスポンスのステータスコードが401であること
- 入力値
    - username: testuser
    - password: wrongpassword
- 備考
    - 事前にtestuserを登録し、異なるパスワードでテスト

### U02-E2007
- 異常系
    - パスワード大文字小文字違い
- テスト観点
    - パスワード照合エラーが発生すること
    - エラーメッセージ「E-U0012」が出力されること
    - レスポンスのステータスコードが401であること
- 入力値
    - username: testuser
    - password: PASSWORD123
- 備考
    - 事前にtestuserをpassword123で登録し、大文字でテスト

### U02-E2008
- 異常系
    - パスワードに余分なスペース
- テスト観点
    - パスワード照合エラーが発生すること
    - エラーメッセージ「E-U0012」が出力されること
    - レスポンスのステータスコードが401であること
- 入力値
    - username: testuser
    - password: password123 (末尾にスペース)
- 備考
    - 事前にtestuserをpassword123で登録し、末尾スペース付きでテスト

## 異常系テスト - システムエラー

### U02-E3001
- 異常系
    - DB接続エラー（ユーザ検索時）
- テスト観点
    - DB接続エラーが発生すること
    - エラーメッセージ「E-U0009」が出力されること
    - レスポンスのステータスコードが500であること
- 入力値
    - username: testuser
    - password: password123
- 備考
    - DBへの接続を意図的に切断した状態でテスト

### U02-E3002
- 異常系
    - パスワード照合処理エラー
- テスト観点
    - パスワード照合処理エラーが発生すること
    - エラーメッセージ「E-U0011」が出力されること
    - レスポンスのステータスコードが500であること
- 入力値
    - username: testuser
    - password: password123
- 備考
    - bcrypt照合処理を意図的に失敗させる

### U02-E3003
- 異常系
    - JWTトークン生成エラー
- テスト観点
    - トークン生成エラーが発生すること
    - エラーメッセージ「E-U0013」が出力されること
    - レスポンスのステータスコードが500であること
- 入力値
    - username: testuser
    - password: password123
- 備考
    - JWT署名処理を意図的に失敗させる

## エッジケーステスト

### U02-E4001
- エッジケース
    - ユーザ名にUnicode文字
- テスト観点
    - バリデーション処理が正しく動作すること
    - 適切なエラーハンドリングが行われること
- 入力値
    - username: test🙂user
    - password: password123
- 備考
    - 英数字とアンダースコア以外の文字に対する処理確認

### U02-E4002
- 異常系
    - SQLインジェクション試行
- テスト観点
    - SQLインジェクション攻撃が防御されること
    - 正常にエラーハンドリングされること
- 入力値
    - username: admin'; DROP TABLE users; --
    - password: password123
- 備考
    - セキュリティテスト
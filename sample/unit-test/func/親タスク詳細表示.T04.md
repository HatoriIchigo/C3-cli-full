# 親タスク詳細表示(T04) テストケース一覧

## 正常系テスト

### T04-C1001
- 正常系
- テスト観点
    - 親タスク詳細と子タスク一覧の取得が正常に完了すること
    - レスポンスのステータスコードが200であること
    - 親タスクの適切なフィールドが返却されること（parent_task_id, title, description, status, created_at, updated_at）
    - 子タスクが作成日時の昇順でソートされること
    - 子タスクの適切なフィールドが返却されること（child_task_id, title, description, status, created_at, updated_at）
- 入力値
    - Authorization: Bearer 有効なJWTトークン
    - 親タスクID: 1
- 期待値
    - HTTPステータス: 200
    - レスポンス: 親タスク詳細 + 子タスク一覧（created_at昇順）
    - ログ: I-T0004

### T04-C1002
- 正常系（子タスクが0件）
- テスト観点
    - 子タスクが0件の場合も正常処理として空配列が返却されること
    - 親タスク詳細は正常に取得されること
    - レスポンスのステータスコードが200であること
- 入力値
    - Authorization: Bearer 有効なJWTトークン
    - 親タスクID: 子タスクを持たない親タスクのID
- 期待値
    - HTTPステータス: 200
    - レスポンス: 親タスク詳細 + 空配列 []
    - ログ: I-T0004

### T04-C1003
- 正常系（複数の子タスク）
- テスト観点
    - 複数の子タスクが作成日時の昇順でソートされて返却されること
    - 親タスクの情報が正確に取得されること
- 入力値
    - Authorization: Bearer 有効なJWTトークン
    - 親タスクID: 複数の子タスクを持つ親タスクのID
- 期待値
    - HTTPステータス: 200
    - レスポンス: 親タスク詳細 + 子タスク一覧（created_at昇順）
    - ログ: I-T0004
- 備考
    - 事前に複数の子タスクを異なる時刻で作成しておく

## 異常系テスト（認証エラー）

### T04-E2001
- 異常系
    - 認証トークンなし
- テスト観点
    - 認証トークンが提供されていない場合のエラー処理
    - エラーメッセージ「E-T0019」が出力されること
    - レスポンスのステータスコードが401であること
- 入力値
    - Authorization: なし
    - 親タスクID: 1
- 期待値
    - HTTPステータス: 401
    - ログ: E-T0019

### T04-E2002
- 異常系
    - 無効な認証トークン
- テスト観点
    - 無効な認証トークンの場合のエラー処理
    - エラーメッセージ「E-T0020」が出力されること
    - レスポンスのステータスコードが401であること
- 入力値
    - Authorization: Bearer 無効なトークン
    - 親タスクID: 1
- 期待値
    - HTTPステータス: 401
    - ログ: E-T0020

### T04-E2003
- 異常系
    - 期限切れの認証トークン
- テスト観点
    - 期限切れの認証トークンの場合のエラー処理
    - エラーメッセージ「E-T0020」が出力されること
    - レスポンスのステータスコードが401であること
- 入力値
    - Authorization: Bearer 期限切れのトークン
    - 親タスクID: 1
- 期待値
    - HTTPステータス: 401
    - ログ: E-T0020

## 異常系テスト（親タスク取得エラー）

### T04-E2004
- 異常系
    - 存在しない親タスクID
- テスト観点
    - 存在しない親タスクIDを指定した場合のエラー処理
    - エラーメッセージ「E-T0022」が出力されること
    - レスポンスのステータスコードが404であること
- 入力値
    - Authorization: Bearer 有効なJWTトークン
    - 親タスクID: 999999
- 期待値
    - HTTPステータス: 404
    - ログ: E-T0022

### T04-E2005
- 異常系
    - 他ユーザの親タスク
- テスト観点
    - 他ユーザが作成した親タスクを取得しようとした場合のエラー処理
    - エラーメッセージ「E-T0022」が出力されること
    - レスポンスのステータスコードが404であること
- 入力値
    - Authorization: Bearer 有効なJWTトークン（ユーザA）
    - 親タスクID: ユーザBが作成した親タスクのID
- 期待値
    - HTTPステータス: 404
    - ログ: E-T0022

### T04-E2006
- 異常系
    - 無効な親タスクID形式
- テスト観点
    - 数値以外の親タスクIDを指定した場合のエラー処理
    - 適切なエラーハンドリングが行われること
- 入力値
    - Authorization: Bearer 有効なJWTトークン
    - 親タスクID: "abc"
- 期待値
    - HTTPステータス: 400または404
- 備考
    - URLパラメータの型変換エラーまたは存在しないタスクとして扱われる

## 異常系テスト（データベースエラー）

### T04-E2007
- 異常系
    - DB接続エラー（親タスク取得時）
- テスト観点
    - 親タスク取得時のDB接続エラーの処理
    - エラーメッセージ「E-T0021」が出力されること
    - レスポンスのステータスコードが500であること
- 入力値
    - Authorization: Bearer 有効なJWTトークン
    - 親タスクID: 1
- 期待値
    - HTTPステータス: 500
    - ログ: E-T0021
- 備考
    - DBを停止して実行

### T04-E2008
- 異常系
    - DB接続エラー（子タスク取得時）
- テスト観点
    - 子タスク取得時のDB接続エラーの処理
    - エラーメッセージ「E-T0023」が出力されること
    - レスポンスのステータスコードが500であること
- 入力値
    - Authorization: Bearer 有効なJWTトークン
    - 親タスクID: 1
- 期待値
    - HTTPステータス: 500
    - ログ: E-T0023
- 備考
    - 親タスク取得後にDBを停止して実行

### T04-E2009
- 異常系
    - DB取得処理エラー（子タスク取得時）
- テスト観点
    - 子タスク取得処理でエラーが発生した場合のエラー処理
    - エラーメッセージ「E-T0024」が出力されること
    - レスポンスのステータスコードが500であること
- 入力値
    - Authorization: Bearer 有効なJWTトークン
    - 親タスクID: 1
- 期待値
    - HTTPステータス: 500
    - ログ: E-T0024
- 備考
    - SQLクエリ実行時にエラーが発生する状況を想定

## 境界値テスト

### T04-C2001
- 正常系（境界値）
- テスト観点
    - 大量の子タスクがある場合も正常に取得できること
    - パフォーマンスが問題ないこと
- 入力値
    - Authorization: Bearer 有効なJWTトークン
    - 親タスクID: 1000件の子タスクを持つ親タスクのID
- 期待値
    - HTTPステータス: 200
    - レスポンス: 親タスク詳細 + 1000件の子タスク一覧（created_at昇順）
    - ログ: I-T0004
- 備考
    - 事前に1000件の子タスクを作成しておく

## セキュリティテスト

### T04-S3001
- セキュリティ
    - 他ユーザの子タスク非表示
- テスト観点
    - 認証ユーザ以外の子タスクが返却されないこと
    - ユーザの分離が適切に行われること
- 入力値
    - Authorization: Bearer 有効なJWTトークン（ユーザA）
    - 親タスクID: ユーザAの親タスクID
- 期待値
    - HTTPステータス: 200
    - レスポンス: ユーザAの親タスクとその子タスクのみ
    - ログ: I-T0004
- 備考
    - 複数ユーザのタスクが混在する環境で実行
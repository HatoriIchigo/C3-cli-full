# ログアウト機能(U03) 単体テストケース一覧

## 概要
- 機能名：ログアウト(U03)
- 概要：ユーザセッションの終了処理機能のテストケース

## 正常系テストケース

### U03-C1001
- 正常系
- テスト観点
  - 正常なログアウト処理が完了すること
  - セッション情報が正常に削除されること
  - レスポンスのステータスコードが200であること
- 入力値
  - JWTトークン: 有効なトークン（eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...）
- 期待結果
  - ログアウト成功
  - セッション情報削除完了
  - ステータスコード: 200

## 異常系テストケース（JWTトークン検証）

### U03-E2001
- 異常系
  - JWTトークンなし
- テスト観点
  - トークン検証エラーが発生すること
  - エラーメッセージ「E-U0301」が出力されること
  - レスポンスのステータスコードが401であること
- 入力値
  - JWTトークン: （なし）

### U03-E2002
- 異常系
  - 無効なJWTトークン（不正な署名）
- テスト観点
  - トークン検証エラーが発生すること
  - エラーメッセージ「E-U0301」が出力されること
  - レスポンスのステータスコードが401であること
- 入力値
  - JWTトークン: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.invalid.signature

### U03-E2003
- 異常系
  - 期限切れJWTトークン
- テスト観点
  - トークン検証エラーが発生すること
  - エラーメッセージ「E-U0301」が出力されること
  - レスポンスのステータスコードが401であること
- 入力値
  - JWTトークン: 期限切れのトークン
- 備考
  - 24時間以上前に発行されたトークンを使用

### U03-E2004
- 異常系
  - 不正な形式のJWTトークン
- テスト観点
  - トークン検証エラーが発生すること
  - エラーメッセージ「E-U0301」が出力されること
  - レスポンスのステータスコードが401であること
- 入力値
  - JWTトークン: invalid-token-format

## 異常系テストケース（セッション情報確認）

### U03-E2005
- 異常系
  - データベース接続エラー（セッション情報確認時）
- テスト観点
  - DB接続エラーが発生すること
  - エラーメッセージ「E-U0302」が出力されること
  - レスポンスのステータスコードが500であること
- 入力値
  - JWTトークン: 有効なトークン
- 備考
  - DBサーバを停止状態でテスト実行

### U03-E2006
- 異常系
  - 存在しないユーザのトークン
- テスト観点
  - ユーザ不存在エラーが発生すること
  - エラーメッセージ「E-U0303」が出力されること
  - レスポンスのステータスコードが404であること
- 入力値
  - JWTトークン: 削除済みユーザのトークン
- 備考
  - 有効なトークンだがユーザが既に削除されている状況

## 異常系テストケース（セッション情報削除）

### U03-E2007
- 異常系
  - データベース接続エラー（セッション情報削除時）
- テスト観点
  - DB接続エラーが発生すること
  - エラーメッセージ「E-U0304」が出力されること
  - レスポンスのステータスコードが500であること
- 入力値
  - JWTトークン: 有効なトークン
- 備考
  - セッション情報確認後、削除処理でDB接続エラーが発生

### U03-E2008
- 異常系
  - セッション情報削除失敗
- テスト観点
  - セッション削除エラーが発生すること
  - エラーメッセージ「E-U0305」が出力されること
  - レスポンスのステータスコードが500であること
- 入力値
  - JWTトークン: 有効なトークン
- 備考
  - DB更新処理で制約違反やロックエラーが発生する状況を模擬

## 境界値テストケース

### U03-E2009
- 異常系
  - トークン有効期限ぎりぎり（期限切れ直前）
- テスト観点
  - トークンが有効として認識されること
  - 正常にログアウト処理が完了すること
- 入力値
  - JWTトークン: 有効期限まで残り1秒のトークン

### U03-E2010
- 異常系
  - トークン有効期限ぎりぎり（期限切れ直後）
- テスト観点
  - トークン検証エラーが発生すること
  - エラーメッセージ「E-U0301」が出力されること
- 入力値
  - JWTトークン: 有効期限を1秒過ぎたトークン

## セキュリティテストケース

### U03-E2011
- 異常系
  - 他ユーザのJWTトークンを使用
- テスト観点
  - 適切にユーザ識別が行われること
  - 該当ユーザのセッション情報のみ削除されること
- 入力値
  - JWTトークン: 別ユーザの有効なトークン
- 備考
  - セキュリティ観点での権限確認テスト

## テストデータ準備

### 事前準備データ
- テスト用ユーザ
  - username: testuser
  - id: 1
  - 有効なJWTトークン
- セッション情報
  - ログイン状態のユーザセッション

### テスト実行後のクリーンアップ
- テスト用セッションデータの確認
- テスト実行ログの確認
- トークン無効化の確認
ログ詳細設計の作成

## インプット
- docs/note/配下（メモ、必須）を読み込み
- docs/base/base-doc.md（基本設計書、必須）を読み込み

## 概要
インプットを元にログの詳細設計を出力。

### ログ設計方針
1. 基本方針
    - ログの形式
    - レベル
    - セキュリティ
    - 運用効率
2. ログレベル
3. ログ出力先

【サンプル】
```markdown
### 2.1 基本方針
- **構造化ログ**: JSON形式でのログ出力により、検索・集計・分析を容易にする
- **レベル管理**: 適切なログレベルにより、運用環境での適切な情報量を確保
- **セキュリティ配慮**: 機密情報（パスワード、個人情報）のログ出力を禁止
- **運用効率**: CloudWatch Logsとの連携により、統合的なログ管理を実現

### 2.2 ログレベル定義
| レベル | 用途 | 出力基準 |
|--------|------|----------|
| ERROR | エラー | システム障害、業務処理エラー、予期しない例外 |
| WARN | 警告 | 回復可能なエラー、パフォーマンス劣化、リトライ処理 |
| INFO | 情報 | 業務処理の開始・終了、API呼び出し、認証関連 |
| DEBUG | デバッグ | 開発・テスト環境での詳細情報、変数値、処理フロー |

### 2.3 ログ出力先
- **開発環境**: コンソール出力（標準出力）
- **本番環境**: ファイル出力 + CloudWatch Logs送信
- **ファイル出力先**: `/var/log/todo-app/`
```

### ログフォーマット仕様
jsonサンプルとフィールドの説明を記載。
**共通**と**コンポーネント別**で作成。

【サンプル】
```markdown
### 3.1 共通フォーマット（JSON）
\`\`\`json
{
  "timestamp": "2024-01-01T10:30:45.123Z",
  "level": "INFO",
  "component": "backend-api",
  "category": "business"
}
\`\`\`

### 3.2 フィールド定義
| フィールド名 | 必須 | 型 | 説明 |
|-------------|------|----|----- |
| timestamp | ○ | string | ISO8601形式のタイムスタンプ（UTC） |
| level | ○ | string | ログレベル（ERROR/WARN/INFO/DEBUG） |
| component | ○ | string | コンポーネント識別子（frontend/backend-api） |
| category | ○ | string | ログカテゴリ（business/system/security/performance） |
```

### セキュリティ考慮事項
【サンプル】
```markdown
### 5.1 ログ出力禁止情報
以下の情報は、ログに出力してはならない：
- パスワード（平文、ハッシュ化前）
- JWTトークンの内容

### 5.2 個人情報の取り扱い
- ユーザIDの出力は許可（個人を特定できない識別子のため）
- IPアドレスの出力は許可（セキュリティ監査のため）

### 5.3 ログアクセス制御
- ログファイルのアクセス権限：`640` (owner: rw, group: r, other: none)
- ログディレクトリの所有者：`ec2-user:ec2-user`
```

### ログローテーション・保持ポリシー
【サンプル】
```markdown
### 6.1 ローカルファイルローテーション
- **ローテーション条件**: 日次ローテーション
- **ローテーション時刻**: 0:00 JST
- **ファイル命名規則**: `{component}.{YYYY-MM-DD}.log`
- **圧縮**: gzip圧縮実行
- **保持期間**: 30日間（基本設計書に準拠）

### 6.2 ローテーション設定例（logrotate）
\`\`\`
/var/log/todo-app/*.log {
    daily
    rotate 30
    compress
    delaycompress
    missingok
    notifempty
    create 640 ec2-user ec2-user
    postrotate
        systemctl reload rsyslog > /dev/null 2>&1 || true
    endscript
}
\`\`\`

### 6.3 CloudWatch Logs保持ポリシー
- **保持期間**: 30日間
- **ロググループ**: `/aws/ec2/todo-app/frontend`, `/aws/ec2/todo-app/backend`
- **ログストリーム**: インスタンスID単位
```

### 監視・アラート設計
【サンプル】
```markdown
### 8.1 ログベースアラート
| アラート名 | 条件 | 閾値 | 通知先 |
|-----------|------|------|--------|
| アプリケーションエラー率 | ERROR レベルログが5%超過 | 5% / 5分間 | メール |
| ログイン失敗急増 | ログイン失敗が10回/分超過 | 10回 / 1分間 | メール |
| データベース接続エラー | DB接続エラーが3回連続 | 3回 / 1分間 | メール |

### 8.2 CloudWatchダッシュボード
- **エラー率推移グラフ**
- **ログインアクティビティ**
- **API レスポンス時間分布**
- **ログ出力量推移**
```


### 運用手順

【サンプル】
```markdown
### 10.1 ログ確認手順
1. **リアルタイム監視**: CloudWatch Logsコンソールでログストリーム確認
2. **エラー調査**: メトリクスフィルターでエラーログを抽出
3. **パフォーマンス分析**: レスポンス時間ログを時系列で分析

### 10.2 障害対応時のログ活用
1. **エラー発生時刻の特定**
2. **関連するrequestIdでログを横断検索**
3. **エラー前後のユーザ操作ログを確認**
4. **システムリソースログとの相関分析**

### 10.3 ログ容量管理
- **日次容量確認**: CloudWatchメトリクスで使用量監視
- **容量超過時対応**: ログレベルの調整、不要ログの削除
- **コスト最適化**: 保持期間の見直し、ログ出力量の調整
```


## アウトプット
docs/detail/log/log.mdに保存


